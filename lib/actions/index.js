"use strict";require("core-js/modules/es.array.concat");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.request=void 0;var _axios=_interopRequireDefault(require("axios"));var _utils=_interopRequireDefault(require("axios/lib/utils"));var _immutable=_interopRequireDefault(require("immutable"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var SETTINGS=_immutable.default.Map();var configure=function configure(request){var protocol=request.protocol,host=request.host,port=request.port,path=request.path,version=request.version,bearerToken=request.bearerToken,session=request.session;var settings=_immutable.default.Map({protocol:protocol,host:host,port:port,path:path,version:version,bearerToken:bearerToken,session:session});if(!_immutable.default.is(SETTINGS,settings)){var defaults=_axios.default.defaults,common=_axios.default.defaults.headers.common;common.Accept='application/json; charset=utf-8';if(bearerToken){common.Authorization="Bearer ".concat(bearerToken);}else{delete common.Authorization;}if(_utils.default.isStandardBrowserEnv()){delete defaults.headers.Cookie;}else{defaults.headers.Cookie="jid=".concat(session);}defaults.withCredentials=true;defaults.baseURL="".concat(protocol,"://").concat(host,":").concat(port,"/").concat(path,"/").concat(version);SETTINGS=settings;}};var request=_axios.default.create();exports.request=request;var _default=function _default(store){var _store$getState=store.getState(),_store$getState$zashi=_store$getState.zashiki;_store$getState$zashi=_store$getState$zashi===void 0?{}:_store$getState$zashi;var request=_store$getState$zashi.request;if(request)configure(request);return function(next){return function(action){var _store$getState2=store.getState(),_store$getState2$zash=_store$getState2.zashiki;_store$getState2$zash=_store$getState2$zash===void 0?{}:_store$getState2$zash;var request=_store$getState2$zash.request;if(request)configure(request);return next(action);};};};exports.default=_default;