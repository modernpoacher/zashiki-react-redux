"use strict";require("core-js/modules/es.object.get-own-property-descriptor");Object.defineProperty(exports,"__esModule",{value:true});exports.watchAlphaChange=watchAlphaChange;exports.watchAlphaFetch=watchAlphaFetch;exports.watchAlphaStore=watchAlphaStore;exports.watchAlphaQuery=watchAlphaQuery;exports.watchAlphaSubmit=watchAlphaSubmit;require("regenerator-runtime/runtime");var _effects=require("redux-saga/effects");var _boom=_interopRequireDefault(require("@hapi/boom"));var _shinkansenSignals=require("shinkansen-signals");var _alpha=require("../../../actions/stages/alpha");var api=_interopRequireWildcard(require("../../../../api/stages/alpha"));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _marked=regeneratorRuntime.mark(changeRouteSaga),_marked2=regeneratorRuntime.mark(fetchRouteSaga),_marked3=regeneratorRuntime.mark(storeRouteSaga),_marked4=regeneratorRuntime.mark(queryRouteSaga),_marked5=regeneratorRuntime.mark(submitRouteSaga),_marked6=regeneratorRuntime.mark(watchAlphaChange),_marked7=regeneratorRuntime.mark(watchAlphaFetch),_marked8=regeneratorRuntime.mark(watchAlphaStore),_marked9=regeneratorRuntime.mark(watchAlphaQuery),_marked10=regeneratorRuntime.mark(watchAlphaSubmit);var ALPHA=_shinkansenSignals.Signals.ALPHA;var getState=function getState(_ref){var _ref$ALPHA=_ref[ALPHA],alpha=_ref$ALPHA===void 0?{}:_ref$ALPHA;return alpha;};var hasStoreError=function hasStoreError(_ref2){var _ref2$ALPHA=_ref2[ALPHA],alpha=_ref2$ALPHA===void 0?{}:_ref2$ALPHA;return'error'in alpha;};var hasQueryError=function hasQueryError(_ref3){var _ref3$ALPHA=_ref3[ALPHA],alpha=_ref3$ALPHA===void 0?{}:_ref3$ALPHA;return'error'in alpha;};function changeRouteSaga(_ref4){var route,_ref5,_ref5$data,response;return regeneratorRuntime.wrap(function changeRouteSaga$(_context){while(1){switch(_context.prev=_context.next){case 0:route=_ref4.route;_context.prev=1;_context.next=4;return(0,_effects.call)(api.changeRoute,route);case 4:_ref5=_context.sent;_ref5$data=_ref5.data;response=_ref5$data===void 0?{}:_ref5$data;_context.next=9;return(0,_effects.put)((0,_alpha.changeRouteFulfilled)(response));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](1);_context.next=15;return(0,_effects.put)((0,_alpha.changeRouteRejected)(_boom.default.badImplementation(_context.t0)));case 15:case"end":return _context.stop();}}},_marked,null,[[1,11]]);}function fetchRouteSaga(_ref6){var route,_ref7,_ref7$data,response;return regeneratorRuntime.wrap(function fetchRouteSaga$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:route=_ref6.route;_context2.prev=1;_context2.next=4;return(0,_effects.call)(api.fetchRoute,route);case 4:_ref7=_context2.sent;_ref7$data=_ref7.data;response=_ref7$data===void 0?{}:_ref7$data;_context2.next=9;return(0,_effects.put)((0,_alpha.fetchRouteFulfilled)(response));case 9:_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2["catch"](1);_context2.next=15;return(0,_effects.put)((0,_alpha.fetchRouteRejected)(_boom.default.badImplementation(_context2.t0)));case 15:case"end":return _context2.stop();}}},_marked2,null,[[1,11]]);}function storeRouteSaga(_ref8){var route,_ref9,_ref9$data,response;return regeneratorRuntime.wrap(function storeRouteSaga$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:route=_ref8.route;_context3.prev=1;_context3.next=4;return(0,_effects.call)(api.storeRoute,route);case 4:_ref9=_context3.sent;_ref9$data=_ref9.data;response=_ref9$data===void 0?{}:_ref9$data;_context3.next=9;return(0,_effects.put)((0,_alpha.storeRouteFulfilled)(response));case 9:_context3.next=15;break;case 11:_context3.prev=11;_context3.t0=_context3["catch"](1);_context3.next=15;return(0,_effects.put)((0,_alpha.storeRouteRejected)(_boom.default.badImplementation(_context3.t0)));case 15:case"end":return _context3.stop();}}},_marked3,null,[[1,11]]);}function queryRouteSaga(){var _ref10,_ref10$data,response;return regeneratorRuntime.wrap(function queryRouteSaga$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return(0,_effects.call)(api.queryRoute);case 3:_ref10=_context4.sent;_ref10$data=_ref10.data;response=_ref10$data===void 0?{}:_ref10$data;_context4.next=8;return(0,_effects.put)((0,_alpha.queryRouteFulfilled)(response));case 8:_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4["catch"](0);_context4.next=14;return(0,_effects.put)((0,_alpha.queryRouteRejected)(_boom.default.badImplementation(_context4.t0)));case 14:case"end":return _context4.stop();}}},_marked4,null,[[0,10]]);}function submitRouteSaga(_ref11){var route,hasError,_hasError,state;return regeneratorRuntime.wrap(function submitRouteSaga$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:route=_ref11.route;_context5.next=3;return(0,_effects.put)((0,_alpha.storeRoute)(route));case 3:_context5.next=5;return(0,_effects.race)([(0,_effects.take)(_alpha.STORE_FULFILLED),(0,_effects.take)(_alpha.STORE_REJECTED)]);case 5:_context5.next=7;return(0,_effects.select)(hasStoreError);case 7:hasError=_context5.sent;if(!hasError){_context5.next=13;break;}_context5.next=11;return(0,_effects.put)((0,_alpha.submitRouteRejected)());case 11:_context5.next=32;break;case 13:_context5.next=15;return(0,_effects.put)((0,_alpha.queryRoute)());case 15:_context5.next=17;return(0,_effects.race)([(0,_effects.take)(_alpha.QUERY_FULFILLED),(0,_effects.take)(_alpha.QUERY_REJECTED)]);case 17:_context5.next=19;return(0,_effects.select)(hasQueryError);case 19:_hasError=_context5.sent;if(!_hasError){_context5.next=25;break;}_context5.next=23;return(0,_effects.put)((0,_alpha.submitRouteRejected)());case 23:_context5.next=32;break;case 25:_context5.next=27;return(0,_effects.select)(getState);case 27:state=_context5.sent;_context5.next=30;return(0,_effects.put)((0,_alpha.submitRouteFulfilled)(state));case 30:_context5.next=32;return(0,_effects.put)((0,_alpha.alphaRoute)(state));case 32:case"end":return _context5.stop();}}},_marked5);}function watchAlphaChange(){return regeneratorRuntime.wrap(function watchAlphaChange$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return(0,_effects.takeLatest)(_alpha.CHANGE,changeRouteSaga);case 2:case"end":return _context6.stop();}}},_marked6);}function watchAlphaFetch(){return regeneratorRuntime.wrap(function watchAlphaFetch$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return(0,_effects.takeLatest)(_alpha.FETCH,fetchRouteSaga);case 2:case"end":return _context7.stop();}}},_marked7);}function watchAlphaStore(){return regeneratorRuntime.wrap(function watchAlphaStore$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return(0,_effects.takeLatest)(_alpha.STORE,storeRouteSaga);case 2:case"end":return _context8.stop();}}},_marked8);}function watchAlphaQuery(){return regeneratorRuntime.wrap(function watchAlphaQuery$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return(0,_effects.takeLatest)(_alpha.QUERY,queryRouteSaga);case 2:case"end":return _context9.stop();}}},_marked9);}function watchAlphaSubmit(){return regeneratorRuntime.wrap(function watchAlphaSubmit$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return(0,_effects.takeLatest)(_alpha.SUBMIT,submitRouteSaga);case 2:case"end":return _context10.stop();}}},_marked10);}