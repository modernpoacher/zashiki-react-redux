"use strict";require("core-js/modules/es.object.to-string");require("core-js/modules/es.promise");Object.defineProperty(exports,"__esModule",{value:true});exports.submit=exports.store=exports.fetch=exports.ZASHIKI_EMBARK_STORE=exports.ZASHIKI_EMBARK_FETCH=exports.ZASHIKI_EMBARK=exports.ZASHIKI_EMBARK_ERROR=void 0;require("regenerator-runtime/runtime");var _=require("../..");var _shinkansenPantograph=require("shinkansen-pantograph");var _shinkansenRails=require("shinkansen-rails");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{Promise.resolve(value).then(_next,_throw);}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value);}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err);}_next(undefined);});};}var _Pantograph$EMBARK=_shinkansenPantograph.Pantograph.EMBARK,ZASHIKI_EMBARK_ERROR=_Pantograph$EMBARK.ERROR,ZASHIKI_EMBARK=_Pantograph$EMBARK.ROUTE,ZASHIKI_EMBARK_FETCH=_Pantograph$EMBARK.FETCH,ZASHIKI_EMBARK_STORE=_Pantograph$EMBARK.STORE;exports.ZASHIKI_EMBARK_STORE=ZASHIKI_EMBARK_STORE;exports.ZASHIKI_EMBARK_FETCH=ZASHIKI_EMBARK_FETCH;exports.ZASHIKI_EMBARK=ZASHIKI_EMBARK;exports.ZASHIKI_EMBARK_ERROR=ZASHIKI_EMBARK_ERROR;function routeError(error){return{type:ZASHIKI_EMBARK_ERROR,error:error};}function embarkRoute(route){return{type:ZASHIKI_EMBARK,payload:{promise:_.request.post('zashiki/embark',route)}};}function fetchRoute(){return{type:ZASHIKI_EMBARK_FETCH,payload:{promise:_.request.get('zashiki/embark/fetch')}};}function storeRoute(route){return{type:ZASHIKI_EMBARK_STORE,payload:{promise:_.request.put('zashiki/embark/store',route)}};}var fetch=function fetch(){return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(dispatch){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return dispatch(fetchRoute());case 3:_context.next=9;break;case 5:_context.prev=5;_context.t0=_context["catch"](0);_context.next=9;return dispatch(routeError(_context.t0));case 9:case"end":return _context.stop();}}},_callee,null,[[0,5]]);}));return function(_x){return _ref.apply(this,arguments);};}();};exports.fetch=fetch;var store=function store(_ref2){var statement=_ref2.statement;return function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(dispatch){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return dispatch(storeRoute({response:{statement:statement}}));case 3:_context2.next=9;break;case 5:_context2.prev=5;_context2.t0=_context2["catch"](0);_context2.next=9;return dispatch(routeError(_context2.t0));case 9:case"end":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};exports.store=store;var submit=function submit(_ref4){var statement=_ref4.statement;return function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(dispatch){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return dispatch(storeRoute({response:{statement:statement}}));case 3:_context3.next=5;return dispatch(embarkRoute({response:{embark:_shinkansenRails.Rails.rail(statement)}}));case 5:_context3.next=11;break;case 7:_context3.prev=7;_context3.t0=_context3["catch"](0);_context3.next=11;return dispatch(routeError(_context3.t0));case 11:case"end":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function(_x3){return _ref5.apply(this,arguments);};}();};exports.submit=submit;